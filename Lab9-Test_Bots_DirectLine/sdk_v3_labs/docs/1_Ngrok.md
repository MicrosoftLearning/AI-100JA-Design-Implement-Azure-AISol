# Ngrok を使用した開発とテスト
 
## 1.	目的
 
Microsoft Bot Framework を使用して、ボットを特定のチャネルで使用できるように構成するには、パブリック URL エンドポイントでボット サービスをホストする必要があります。チャネルが NAT またはファイアウォールの背後に隠れているローカル サーバー ポート上にある場合、チャネルはボット サービスにアクセスできません。
  
コードを設計/構築/テストする場合、必ずしも再デプロイを続ける必要はありません。これにより、ホスティング コストが増加します。ここで、ngrok がボットの開発/テスト フェーズを高速化するのに非常に役立ちます。このラボの目的は、ngrok を使用してボットをパブリック インターネットに公開し、パブリック エンドポイントを使用してエミュレーターでボットをテストすることです。
  
## 2.	セットアップ
  
 a.	  ngrok がインストールされていない場合は、https://ngrok.com/download からダウンロードして、OS にインストールします。ngrok ファイルを解凍してインストールします。

 b.	  (前のラボの) ボット プロジェクトを開くか、「Bot Application」プロジェクト テンプレートを使用して新しい EchoBot を作成します。ボットを実行します。EchoBot を作成する場合、ブラウザーに次のメッセージが表示されます。

**EchoBot**

ここでボットと使用条件などを説明してください。

Bot Framework にアクセスしてボットを登録します。登録するときは、ボットのエンドポイントを https://your_bots_hostname/api/messages に設定してください。

*** 上記は情報提供のみを目的としています。このラボ用にボットを登録する必要はありません。

## 3.	転送

 a.	 ボットが localhost:3979 でホストされている場合、ngrok を使用してこのポートをパブリック インターネットに公開できます。

 b.	 端末を開き、ngrok がインストールされているフォルダーに移動します。
 
 c.	 以下のコマンドを実行すると、転送 URL が表示されます。

 ````ngrok.exe http 3979 -host-header="localhost:3979"````

![転送 URL](images/ForwardingUrl.png)

 e.	 Bot Emulator に転送 URL (http) を入力します。ボットの URL には、/api/messages が追加された転送 URL があります。メッセージを送信して、Emulator 内のボットをテストします。これで、localhost の代わりにパブリック エンドポイントを使用してボットをテストしました。


![ボットの URL](images/BotUrl.png)

## 4.	予定より早く終了した場合追加クレジットのために、この演習をお試しください。

 Microsoft Bot Framework にボットを登録するときに、メッセージング エンドポイントの転送 URL を使用できますか。任意のチャネルの転送 URL (skype など) を使用して、チャネル上のボットをテストします。

 ### [2_Unit_Testing_Bots](2_Unit_Testing_Bots.md) に進みましょう

 [README](../0_README.md) に戻る
